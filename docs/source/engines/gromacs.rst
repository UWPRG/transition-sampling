GROMACS Documentation
=====================

..  toctree::
    :maxdepth: 1

GROMACS Specific Inputs
-----------------------
In addition to the inputs required by all :doc:`engines <engines>`, the GROMACS specific inputs are listed below.

Template Input Files
^^^^^^^^^^^^^^^^^^^^
These three files make up the base case simulation. None of the original files will be modified

``mdp_file`` - path to the .mdp file to be used
    The path to a well formed GROMACS .mdp file that specifies the simulation parameters. All existing parameters will be
    used, except:

    #. Any velocity generation - Aimless shooting will generate its own starting velocities
    #. The trajectory print frequency - This is modified for individual shootings to extract to relevant :math:`\Delta t` positions

``gro_file`` - path to a template .gro file to be used
    The path to a corresponding .gro file. The coordinates and velocities of atoms do not need to reflect a transition state,
    this file is primarily used to define the atoms and their indices. Starting positions will be initialized from the
    start directory, and new velocities will be generated by aimless shooting.

``top_file`` - path to a .top file corresponding to the system.
    Nothing in this file will be modified.

Additional Commands
^^^^^^^^^^^^^^^^^^^
For ``md_cmd``, you should include ``mdrun``, e.g.:
    * ``"md_cmd": "gmx_mpi mdrun"``

    This should use the number of cores desired for `one` simulation. Each parallel simulation will be pinned to different
    cores (if enough are available) automatically by aimless shooting.

``grompp_cmd`` - command to compile a simulation to a .tpr
    This command will be used to compile a .mdp, a .gro, and a .top file into a .tpr before running a simulation, e.g.:

    * ``"grompp_cmd": "gmx_mpi grompp"``

GROMACS Outputs
---------------
If GROMACS ``grompp`` or ``mdrun`` exits with a non-zero exit code, the output file is copied from the engine's working
directory with the name ``{projname}_FATAL.log``, where ``projname`` is the root name of that shooting point.
Additionally, all std out and std err is logged as a warning, with a note that this simulation failed. Note that this is
not necessarily terminal, as multiple velocities are resampled. If many of these are occurring, something is likely wrong.

At this time, warnings are not checked in either ``grompp`` or ``mdrun``'s output.

Additional Logging
------------------
Setting ``log_level = DEBUG`` will log the individual commands used for each ``grompp`` and ``mdrun`` so you can ensure
they match your expectations.
